<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org">

<head>
  <meta content="width=device-width, initial-scale=1" name="viewport" />
  <meta charset="UTF-8" />
  <!-- 修正: 存在するバージョンに修正 -->
  <link href="/webjars/bootstrap/5.3.7/css/bootstrap.min.css" rel="stylesheet" />
  <link href="/webjars/bootstrap-icons/1.13.1/font/bootstrap-icons.min.css" rel="stylesheet" />
  <link href="/css/style.css" rel="stylesheet" />
  <script defer src="/webjars/jquery/3.7.1/jquery.min.js"></script>
  <script defer src="/webjars/bootstrap/5.3.7/js/bootstrap.bundle.min.js"></script>
  <script defer src="/js/main.js"></script>
  <script defer th:inline="javascript">
    /*<![CDATA[*/
    document.addEventListener('DOMContentLoaded', function () {
      // --- エラーモーダルの自動表示 ---
      const errorMessage = /*[[${errorMessage}]]*/ null;
      if (errorMessage) {
        const errorModalElement = document.getElementById('errorModal');
        const errorModal = new bootstrap.Modal(errorModalElement);
        errorModal.show();
      }
    });
    /*]]>*/
  </script>
  <title th:text="${currentScreen ?: 'メインページ'}" </ />
</head>

<body>

  <!-- ヘッダー -->
  <header class="header">
    <div class="d-flex align-items-center h-100 px-3 px-md-5 position-relative">
      <div>
        <button aria-controls="sidebarMenu" class="btn btn-primary d-md-none border-0" data-bs-target="#sidebarMenu"
          data-bs-toggle="offcanvas" type="button">
          <i class="bi bi-list"></i>
        </button>
        <button class="btn btn-primary d-none d-md-block border-0" id="pcSidebarToggle" type="button">
          <i class="bi bi-list"></i>
        </button>
      </div>
      <div class="position-absolute top-50 start-50 translate-middle">
        <button class="btn btn-secondary" data-bs-target="#scrollableModal" data-bs-toggle="modal" id="itemSelectButton"
          type="button">
          <!-- 修正: より簡潔なエルビス演算子を使用 -->
          <span id="selectedItemName" th:text="${selectedScreenName ?: '画面を選択'}">画面を選択</span>
        </button>
      </div>
    </div>
  </header>

  <!-- サイドバー -->
  <div aria-labelledby="sidebarMenuLabel" class="offcanvas offcanvas-start offcanvas-md is-collapsed" id="sidebarMenu"
    tabindex="-1">
    <div class="offcanvas-body p-0">
      <ul class="nav flex-column">
        <li class="nav-item">
          <a class="nav-link text-dark" href="/">
            <i class="bi bi-house-door-fill"></i>
            <span>Home</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link text-dark" href="#">
            <i class="bi bi-speedometer2"></i>
            <span>Dashboard</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link text-dark" href="#">
            <i class="bi bi-gear-fill"></i>
            <span>Settings</span>
          </a>
        </li>
      </ul>
    </div>
  </div>

  <!-- メインコンテンツ -->
  <main class="main-content p-4 is-collapsed">
    <div class="container-fluid">
      <!-- 修正: 重複したcaseを削除 -->
      <div th:switch="${currentScreen}">
        <div th:case="'ホーム'">
          <div th:replace="~{fragments/home :: content}"></div>
        </div>
        <div th:case="'ダッシュボード'">
          <div th:replace="~{fragments/dashboard :: content}"></div>
        </div>
        <div th:case="'設定'">
          <div th:replace="~{fragments/settings :: content}"></div>
        </div>
        <div th:case="*">
          <p>上のボタンから表示する画面を選択してください。</p>
        </div>
      </div>
    </div>
  </main>
  <div th:replace="~{fragments/modals/errorModal :: content}"></div>
  <div th:replace="~{fragments/modals/contentModal :: content}"></div>



</body>

</html>